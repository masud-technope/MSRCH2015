thread_ID, Id, ParentId, PostType, Score, CreationDate, OwnerID, Body
53409910,53409910,null,1,0,Wed Nov 21 10:21:00 EST 2018,4470334,"<p>I'm trying to use Google Cloud Platform to make a little IoT project.</p>		<p>I've created a registry and a device in the "IoT Core" section and connected the registry to a default topic.	I've also specified three subfolders for that topic: "events", "config" and "status".	Now, I would like to connect a "Cloud Function" for the incoming messages but I can't find how to configure a single subfolder to monitor neither how to publish messages on them in the "Cloud Pub/Sub" section.</p>		<p>All the documentation talks about single topics so.... Am I missing some base concept on how it works?</p>	"
53409910,93965270,53409910,3,0,Fri Nov 30 00:02:00 EST 2018,9398998,"Please consider to accept the answer that you found useful."
53409910,53463445,53409910,2,0,Sat Nov 24 23:51:00 EST 2018,10648082,"<p>I believe the correct way to set this up would be to set up one pubsub topic for each subfolder.  From the cloud iot core documentation:</p>		<blockquote>	  <p>Devices can publish data to separate Pub/Sub topics by specifying a subfolder in the MQTT topic. The subfolder is the subtopic after {device-id}/events. For example, if the device publishes to the MQTT topic /devices/{device-id}/events/alerts, the subfolder is the string alerts. This subfolder must be configured in the device registry resource's eventNotificationConfigs.subfolderMatches field with a matching Pub/Sub topic in the eventNotificationConfigs.pubsubTopicName field. When data is sent to a subfolder, it is published to the subfolder's matching Pub/Sub topic.</p>	</blockquote>		<p><a href="https://cloud.google.com/iot/docs/how-tos/mqtt-bridge#publishing_telemetry_events_to_separate_pubsub_topics" rel="nofollow noreferrer">https://cloud.google.com/iot/docs/how-tos/mqtt-bridge#publishing_telemetry_events_to_separate_pubsub_topics</a></p>	"
53409910,53487130,53409910,2,0,Mon Nov 26 18:37:00 EST 2018,3534690,"<p>Need to back up a step. What are you trying to do with the various subfolders? This may be a misunderstanding with how communication works with the device to and from the Cloud.</p>		<p>So, there's 3 MQTT topics, those are the events/config/state (not status). Those DON'T map to Pub/Sub topics at all. They're each handled separately in IoT Core.</p>		<p>Events is device->Cloud, and gets put into the Pub/Sub topic you specify when creating the registry. Setting subfolders is all about splitting telemetry from the same device to multiple places for handling. So, e.g. you have temp data you want to go in one pub/sub topic, and pressure data you want into another. The other way to handle this would be to attach the function to the main pub/sub topic, parse the telemetry, and then re-issue a Pub/Sub message to different places depending on the payload itself.</p>		<p>Config is Cloud->device, and is initiated by calls to the IoT Core Admin SDK. If your device subscribes to the /config/ MQTT topic, then they'll get a callback on the MQTT client's on_message handler (exact code depends on library being used of course) when some external entity sends a config message to IoT Core for your device.</p>		<p>State is device->Cloud but is specially handled, and doesn't go to any Pub/Sub topic. The results can be retrieved by the IoT Core Admin SDK. It's a way for the device to report its state and then external processes/applications to get that status without having to call back down to the device itself. This is particularly useful when you have devices which don't remain connected, for example, but you still want to be able to do things based on the last known state.</p>		<p>So the only one that you can use Cloud Functions with is the /events/ topic. That's done by deploying a Cloud Function and choosing the Pub/Sub publish event hook as the firing mechanism for the function, and specifying the IoT Core's registry Pub/Sub topic as the source of the events. Then anytime your device publishes telemetry to the /events/ MQTT topic, it'll get published to that Pub/Sub topic (confusing I know because we call them both topics) and the Cloud Function will fire.</p>		<p>Hopefully this clarifies what's going on? Or did I totally miss the question? :)</p>	"
53409910,94298131,53487130,3,0,Tue Dec 11 10:38:00 EST 2018,4470334,"Thank you for the explaination! I totally misunderstood the documentation, now is more clear.		Just to be sure, in your example and without using a function, how can I split the telemetry message in one pub/sub topic and pressure data into another? Is there a way to configure this in IoT Core?"
53409910,94312943,53487130,3,0,Tue Dec 11 17:46:00 EST 2018,3534690,"You can yes. When you create the registry in IoT Core, and it asks for a telemetry topic, there's a link that reads "Add more telemetry topics". Expanding that gives an interface for adding topic and subfolder. You can specify individual (different) Pub/Sub topics associated with a subfolder. To then split the data, you'd send telemetry messages, for example, to /events/telemetry/ MQTT topic, and pressure data to /events/pressure/ MQTT topic. Then you can have separate actions on each Pub/Sub topic where they get routed."
