thread_ID, Id, ParentId, PostType, Score, CreationDate, OwnerID, Body
47657680,47657680,null,1,0,Tue Dec 05 15:55:00 EST 2017,985764,"<p>I am confused about RabbitMQ and the federated plugin.  Therefore, I seem unable to set it up to work.</p>		<p>Let's say I have 'n' number of raspberry pi s  (rpi1, rpi2, rpi3... rpin)</p>		<p>I want them all to send messages to a cloud server (c1).</p>		<p>They will have intermittent connections to the internet so I want them all to queue their messages locally before sending to the server.  Then when they come online to send their messages to c1 so that I can retrieve them off a queue.  I want all of the messages to go to one queue.</p>		<p>I set up rabbitmq on all of the hosts.</p>		<p>Here is what I have done:</p>		<p>I configure upstreams on all of the raspberry pi s</p>		<pre><code>rabbitmqctl set_parameter federation-upstream my-upstream '{"uri":"amqp://user:pwd@c1.foo.com","expires":3600000}'	rabbitmqctl set_policy --apply-to exchanges federate-me "^amq\." '{"federation-upstream-set":"all"}'	</code></pre>		<p>The exchanges seem to set themselves up on the server</p>		<p>I cannot seem to figure out how to add a message to a rpi queue and have it show up on the server.</p>		<p>What am I missing? </p>		<ol>	<li>Is federation what I want? </li>	<li>what do I have to do on c1 to get it to take incoming messages and drop them into a queue?</li>	<li>what do I have to do on the rpi s to have them send their messages to the server</li>	<li>Is this a good path for what I am attempting?</li>	</ol>		<p>Totally lost.  Thanks for your help!!</p>	"
47657680,47669380,47657680,2,0,Wed Dec 06 07:55:00 EST 2017,3864737,"<p>From the use case you're describing, federation seems like the right path for you.</p>		<p>From the <a href="https://www.rabbitmq.com/federation.html" rel="nofollow noreferrer">documentation</a>:</p>		<blockquote>	  <p>The federation plugin uses AMQP 0-9-1 to communicate between brokers, and is designed to tolerate intermittent connectivity.</p>	</blockquote>		<p>The issue with your setup is that you've done the configuration on the upstream nodes, while <a href="https://www.rabbitmq.com/federated-exchanges.html" rel="nofollow noreferrer">it should be done on the federated node:</a></p>		<blockquote>	  <p>A federated exchange links to other exchanges (called upstream exchanges). Logically (see next item), messages published to the upstream exchanges are copied to the federated exchange, as though they were published directly to it. The upstream exchanges do not need to be reconfigured and they do not have to be on the same broker or in the same cluster.</p>	</blockquote>		<p>So no action on the rpis, configuration is on c1.</p>		<ol>	<li>Create an upstream in c1 for each of the rpis</li>	<li>Create a federation upstream set with all the upstreams you have created</li>	<li>Add a policy to link the target exchanges on the rpis to the exchanges on c1, referencing the federation upstream set you have defined (as the "all" one refers to all the upstreams, that could be fitting for your use case of course, just find it cleaner to be specific)</li>	</ol>	"
