thread_ID, Id, ParentId, PostType, Score, CreationDate, OwnerID, Body
39299825,39299825,null,1,1,Fri Sep 02 19:53:00 EDT 2016,478213,"<p>I have the following running (finally after installing libnet etc) on my Mac trying to listen for a Dash button's MAC address:</p>		<pre><code>from scapy.all import *		def arp_display(pkt):	  if pkt[ARP].op == 1: #who-has (request)	    if pkt[ARP].psrc == '0.0.0.0': # ARP Probe	      print ("ARP Probe from: " + pkt[ARP].hwsrc)		print (sniff(prn=arp_display, filter="arp", store=0, count=300))	</code></pre>		<p>However, this just runs indefinitely and nothing is picked up even after numerous presses on the Dash and many other devices connecting and disconnecting.</p>		<p>I tried the following too</p>		<pre><code>from scapy.all import *		print (sniff(filter="arp",count=10).summary())	</code></pre>		<p>Which also yields no results. Nothing I find online tells me what might be causing this.</p>		<p>Any ideas? Or even how I could debug?</p>	"
39299825,65933895,39299825,3,0,Fri Sep 02 20:04:00 EDT 2016,3745413,"You need to place your Wi-Fi adapter into monitor mode. This will prevent you from using it as a regular network connection during the period you have it in monitor mode."
39299825,65934058,39299825,3,0,Fri Sep 02 20:10:00 EDT 2016,478213,"Would I need to keep it in monitor mode the whole time"
39299825,65934087,39299825,3,0,Fri Sep 02 20:11:00 EDT 2016,3745413,"You can only sniff the airwaves while in monitor mode. When you are done sniffing, you can take it out of monitor mode."
39299825,65934155,39299825,3,0,Fri Sep 02 20:14:00 EDT 2016,478213,"Thanks. Is there a generic way to put the mac in this mode?"
39299825,65934185,39299825,3,0,Fri Sep 02 20:15:00 EDT 2016,3745413,"You are asking this on the wrong SE site. Try to ask it on [su] or [apple.se]."
39299825,39787889,39299825,2,2,Fri Sep 30 09:14:00 EDT 2016,969329,"<p>The new buttons don't put out the same ARP request as the old ones. Remove this line and it should work.</p>		<pre><code>if pkt[ARP].psrc == '0.0.0.0': # ARP Probe	</code></pre>	"
39299825,68840077,39787889,3,0,Fri Nov 25 17:10:00 EST 2016,1432213,""0.0.0.0" is an intrinsic part of ARP, and has nothing to do with Dash button having a later revision. The button, as it powers up after a press, needs to make sure that it's MAC address is unique and so sends a broadcast (aka "to the entire network" aka "to 0.0.0.0") an ARP who-has request. In linux run "sudo tcpdump -e -i eth0 arp" to see these Broadcast events along with responses. I have dash buttons bought yesterday, and they all do this. I think the issue lies deeper in the scapy library, as I'm seeing different things in my tcpdump and in scapy right now."
39299825,68840449,39787889,3,0,Fri Nov 25 17:24:00 EST 2016,1432213,"Ok, I'm going to back down a little on my earlier comment. It would appear that the Dash holds a cache of the IP address it was last given by DHCP, and uses that. So if you remove that line, you'll see the packet. Additionally right at the top level you could include "if pkt.haslayer(ARP):" to test for ARP packets first. I was getting lots of "IndexError: Layer [ARP] not found" exceptions, and this clears that up."
