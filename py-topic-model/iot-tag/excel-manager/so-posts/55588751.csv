thread_ID, Id, ParentId, PostType, Score, CreationDate, OwnerID, Body
55588751,55588751,null,1,0,Tue Apr 09 08:53:00 EDT 2019,3725569,"<p>I have an ESP8266 and want to send messages to a MS-Teams channel. In the future I want to send temperature data but for now I am okay with whatever.	Right now I can connect to the host but it will not send any data to the team and it gives no error.	It works without any problems from Postman and the webhook also works from Python. </p>		<p>Here is my code:</p>		<pre><code>#include "ESP8266HTTPClient.h"	#include "ESP8266WiFi.h"	#include &lt;ArduinoJson.h&gt;	#include &lt;WiFiClientSecure.h&gt;		void setup() {	  Serial.begin(9600);                                  //Serial connection	  WiFi.begin("", ""); //WiFi connection	  while (WiFi.status() != WL_CONNECTED) { //Wait for the WiFI connection completion 	    delay(500);	    Serial.println("Waiting for connection");	  }	}		void MicrosoftTeams() {	  char host[] = "outlook.office.com"; //Specify request destination";	  WiFiClient client;	  if (client.connect(host, 443)) {	    Serial.println("connected");		    String url = "/webhook/Webhookcode";	    char json[] = "{  \"@context\": 	 \"https://schema.org/extensions\",\"@type\": 	 \"MessageCard\",\"themeColor\": \"0072C6\",\"title\": 	 \"meddelande\",\"text\": \"Hello!!\"}";	    int len = strlen(json);		    String Output = "POST " + url + " HTTP/1.1\r\n" +	                    "Host: " + host + "\r\n" +	                    "Content-Type: application/json\r\n" +	                    "User-Agent: arduino/1.0\r\n" +	                    "Content-Length: " + len + "\r\n" +	                    "\r\n" +	                    json + "\n";		    client.print(Output);	    while (client.available()) {	      String line = client.readStringUntil('\r');	      Serial.print(line);	    }	  }	}		void loop() {	  if (WiFi.status() == WL_CONNECTED) { //Check WiFi connection status	    MicrosoftTeams();	  } else {	    Serial.println("Error in WiFi connection");	  }	  delay(30000); //Send a request every 30 seconds	}	</code></pre>		<p><strong>Update:</strong>	Ive tested the following function and it works in this test example but not the real case. If i change the WiFiClient to WiFiClientSecure everything stops working.</p>		<pre><code>void WifiCliwaySecure()	{	  //Work	      WiFiClient  client;	  const int httpPort = 80;	  // //Doenst work	  //   WiFiClientSecure  client;	  // const int httpPort = 443;	  char host[] = "ptsv2.com";	  if (!client.connect(host, httpPort)) {	    Serial.println("connection failed");	    return;	  }		    String url = "/t/erzs7-1555484154/post";	   Serial.print("Requesting POST: ");	   // Send request to the server:	 String data = "{ \"title\": \"meddelande\",\"text\": \"Hall√• alla bk!!\"}";	  client.print(String("POST ") + url + " HTTP/1.1\r\n" +	               "Host: " + host + "\r\n" +	               "User-Agent: BuildFailureDetectorESP8266\r\n" +	               "Content-Length: " + data.length() + "\r\n" +	               "Content-Type: application/json\r\n" +	               "\r\n" + 	               data +	               "\r\n");	Serial.print("url Send");		   delay(500); // Can be changed	  if (client.connected()) { 	    client.stop();  // DISCONNECT FROM THE SERVER	  }	  Serial.println();	  Serial.println("closing connection");	}	</code></pre>	"
55588751,97998690,55588751,3,0,Fri Apr 12 15:28:00 EDT 2019,757471,"I'm also pretty certain that you should be using WiFiClientSecure instead of WiFiClient. Beware that HTTPS may need more RAM than is available and for this reason can cause your ESP8266 to freeze or reboot unexpectedly."
55588751,98127966,55588751,3,0,Wed Apr 17 09:42:00 EDT 2019,3725569,"@phil i updated the code, 	The problem to the test is that if the port is 443 or the client is WiFiClientSecure it doesnt work. Se the updated part."
55588751,97997231,55588751,3,0,Fri Apr 12 14:48:00 EDT 2019,757471,"Are you able to prove that this code works for a simpler case? For example over HTTP instead of HTTPS? As a way of narrowing down exactly where the problem lies?"
55588751,98278424,55588751,3,0,Tue Apr 23 06:16:00 EDT 2019,3725569,"Ok thank you  @phil"
55588751,98140199,55588751,3,0,Wed Apr 17 15:06:00 EDT 2019,757471,"WifiClient works when you connect to remote port 80 because it is HTTP and therefore not encrypted. It won't work when you connect to remote port 443 because it is HTTPS (encrypted), which WifiClient doesn't support. I'll add an answer in the next couple of days showing you how to get your WifiClientSecure version working."
