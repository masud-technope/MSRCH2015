thread_ID, Id, ParentId, PostType, Score, CreationDate, OwnerID, Body
36289471,36289471,null,1,0,Tue Mar 29 16:05:00 EDT 2016,3182574,"<p>I am having mosquitto broker running on Ubuntu on EC2. Also I did a change <code>max_queued_messages 1000</code> and <code>max_inflight_messages 10</code> in <code>/etc/mosquitto/mosquitto.conf</code></p>		<p>I am publishing to this broker with <strong>qos=2</strong> and <strong>retain enabled</strong>. For publishing I am using <code>mosquitto_pub -t 1 -m "{c:{d:\"pN\",m:\"Pr1\"}}" -r -q 2</code>. And subscriber side I am using  <code>org.eclipse.paho.android.service:1.0.2</code> library with same qos=2. <br>and only providing single option by <code>options.setMqttVersion(MqttConnectOptions.MQTT_VERSION_3_1)</code> for parameters to <code>client.connect(options)</code>.</p>		<p>Problem is coming if subscriber device connected to the server disconnects and reconnects again due to any reason, then getting only single last retained message, it is missing the all in between messages.	<br>And also if nothing even published yet, still after reconnecting gets the last retained message which subscriber device might had already got before disconnecting.</p>		<p>I want that after reconnecting subscriber should get all messages which were published in the period of disconnection and if already got then should not shown again. Wanted to know how and where to do it.</p>	"
36289471,36290795,36289471,2,4,Tue Mar 29 17:12:00 EDT 2016,504554,"<p>The last retained message published will always be delivered when you subscribe to a topic even if it has already been delivered before no mater what QOS level. This is intentional and there is no way to stop it if the message is published as retained. (Just to be clear, publishing a message with the retained flag will replace the last retained message and does not queue up all retained messages.)</p>		<p>As for not getting the messages published between a disconnect/reconnect this implies that the client it passing the <code>cleansession=true</code> connection option. If you want to have the missed messages delivered then you need to ensure the <code>cleansession</code> flag is set to <code>false</code> at connection time. This is totally independent of if messages are published with the retained flag.</p>	"
36289471,60231607,36290795,3,0,Wed Mar 30 08:50:00 EDT 2016,3182574,"now added options.setCleanSession(false); and for client ID I am using imei no to keep it unique and same for every time client reconnects. Still not getting the missed message any thing else need to be taken care of? either in broker or paho client?"
36289471,60232426,36290795,3,0,Wed Mar 30 09:10:00 EDT 2016,3182574,"Oh sorry It is working, for testing I was destroying the service with unsubscribe and disconnect and on disconnect It is not getting the message, but when only I turn off the internet and start it is getting all the missed messages. This is what I actually need. Thanks a lot :-)"
