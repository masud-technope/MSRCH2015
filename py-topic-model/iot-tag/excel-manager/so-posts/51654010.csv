thread_ID, Id, ParentId, PostType, Score, CreationDate, OwnerID, Body
51654010,51654010,null,1,0,Thu Aug 02 12:44:00 EDT 2018,681671,"<p>My client connects with the following parameters:</p>		<ol>	<li>Clean Session: False</li>	<li>Client ID: Fixed (same every time) </li>	<li>Subscribed with QoS=1</li>	<li>Message Published with QoS=1</li>	</ol>		<p>I am trying to verify that if the broker receives messages when the client is offline, the messages are queued on the broker and sent to client when it comes online again.</p>		<p>However, I find that the broker does not send anything to the client on reconnect.</p>		<p>This is how I tested:	Connect client to broker using the four parameters mentioned above.	Subscribe to topics of interest with QoS=1	Disconnect client</p>		<p>Using another client program and another client id, connect to the broker	Publish message to the same topic that was subscribed to by the now offline client. 	Wait for a few seconds, now reconnect the offline client with the same connection settings as before.</p>		<p><strong>Expected Result</strong>: As soon as connection is re-established the client will receive messages that were sent to its topic while it was offline.</p>		<p><strong>Actual Result</strong>: Client gets no messages. It is able to receive any new messages that are sent AFTER it is connected, but no offline messages.**</p>		<p>I have verified using <strong>Wireshark</strong> that the SUBSCRIBE and message PUBLISH packets sent to the server have QoS=1 and clean session flag is false in CONNECT packet. </p>		<p>Broker: Mosquitto v1.4.11 </p>		<p>MQTT Config File:</p>		<pre><code>pid_file /var/run/mosquitto.pid		persistence true	persistence_location /var/lib/mosquitto/		log_dest file /var/log/mosquitto/mosquitto.log	log_type debug		listener 9001	protocol websockets		listener 1883	protocol mqtt		allow_anonymous false	acl_file /path/to/acl_file	password_file /path/to/password_file	</code></pre>	"
51654010,90280720,51654010,3,0,Thu Aug 02 16:46:00 EDT 2018,681671,"I should not have to because the broker is supposed to remember my previous subscription since even the previous connection was started with cleanSession=false."
51654010,90280729,51654010,3,0,Thu Aug 02 16:46:00 EDT 2018,681671,"Anyway, I did try resubscribing as well. I got nothing."
51654010,90280800,51654010,3,0,Thu Aug 02 16:48:00 EDT 2018,504554,"Update the question with your mosquitto config file"
51654010,90280992,51654010,3,0,Thu Aug 02 16:54:00 EDT 2018,681671,"Added the config in question"
51654010,90273096,51654010,3,0,Thu Aug 02 13:27:00 EDT 2018,504554,"are you resubscribing to the the topic when you reconnect?"
51654010,90283834,51654010,3,0,Thu Aug 02 18:35:00 EDT 2018,681671,"This in on a linux machine. Now I tried with a fresh install of Mosquitto on a Windows machine and the issue is exactly the same."
51654010,51662019,51654010,2,0,Thu Aug 02 20:54:00 EDT 2018,681671,"<p>It was a case of misbehaving  GUI clients. Three of them!</p>		<p>I am posting it so that others don't waste time on something similar.</p>		<p>I tried three clients, all had different probelms as mentioned below:</p>		<p><strong>MQTT.fx</strong>: The broker does deliver message immediately after connect but the topic has not been subscribed to in the current session so MQTT.fx does not have any designated place to show the received message. So it does not show the message on screen.	MQTT.fx also complicates Wireshark debugging by subscribing to $SYS logs topic which floods Wireshark and the main message from broker is lost in the flood of packets.</p>		<p><strong>MQTT Spy</strong>: Unlike MQTT.fx, it has a catch all tab, so if the broker sends a message that was not subscribed to in the current session, it will show it in the catch all tab. Unfortunately, the implementers of MQTT Spy have decided that their application will unsubscribe to all topics before disconnect. Since the client is no longer subscribed to the topic, the borker does not queue any messages for it.</p>		<p><strong>MQTT Lens</strong>: It has a bug. It does not save the connection settings for Clean Session. Even if you set clean session to false, it always opens connection with clean session=true.</p>		<hr>		<p>Finally, I wrote a test program with Paho Java library and found everything to be working as expected.</p>		<p>I wonder why there is not reference implementation GUI client for MQTT all the current implementations are either broken or so unnecessarily "smart" that they prevent you from testing a legitimate test case.</p>	"
