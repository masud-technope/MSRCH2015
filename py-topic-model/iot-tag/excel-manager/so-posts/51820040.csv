thread_ID, Id, ParentId, PostType, Score, CreationDate, OwnerID, Body
51820040,51820040,null,1,0,Mon Aug 13 10:18:00 EDT 2018,9806736,"<p>I was trying to send a command to my device from an IBM app, and using <a href="https://www.coursera.org/lecture/developer-iot/sending-commands-to-a-device-8U0ri" rel="nofollow noreferrer">this page</a> and <a href="https://developer.ibm.com/recipes/tutorials/connecting-raspberry-pi-as-a-gateway-to-watson-iot-using-node-red/" rel="nofollow noreferrer">this page</a>as reference.<br></p>		<p>When I set the Watson IoT input node's property "connect as" to "Gateway" and deploy it, my Node-RED crashes and restarts. It doesn't crash when I set it to "Device".</p>		<p><img src="https://i.stack.imgur.com/DXFxy.jpg" alt="img of the properties"></p>		<p>When it crashes, the console gives me this log.</p>		<blockquote>	  <p>Welcome to Node-RED<br>	  13 Aug 18:10:01 - [info] Node-RED version: v0.18.4<br>	  13 Aug 18:10:01 - [info] Node.js  version: v4.8.2<br>	  13 Aug 18:10:01 - [info] Linux 4.9.80-v7+ arm LE<br>	  13 Aug 18:10:02 - [info] Loading palette nodes<br>	  13 Aug 18:10:07 - [info] Dashboard version 2.9.1 started at /ui<br>	  13 Aug 18:10:09 - [info] Settings file  : /usr/lib/node_modules/node-red/settings.js<br>	  13 Aug 18:10:09 - [info] User directory : /home/pi/.node-red<br>	  13 Aug 18:10:09 - [warn] Projects disabled : set editorTheme.projects.enabled=true to enable<br>	  13 Aug 18:10:09 - [info] Flows file     : /home/pi/.node-red/flows_pi3-0.json<br>	  13 Aug 18:10:09 - [info] Server now running at <a href="http://127.0.0.1:1880/" rel="nofollow noreferrer">http://127.0.0.1:1880/</a><br>	  13 Aug 18:10:09 - [info] Starting flows<br>	  [BaseClient:connect] Connecting to IoTF with host : ssl://h4v0iz.messaging.internetofthings.ibmcloud.com:8883 and with client id : d:h4v0iz:RaspberryPi:radberrypi<br>	  13 Aug 18:10:10 - [info] Started flows<br>	  13 Aug 18:10:10 - [info] serial port /dev/ttyUSB0 opened at 57600 baud 8N1	  [DeviceClient:connect] DeviceClient Connected<br>	  13 Aug 18:10:12 - [red] Uncaught Exception:<br>	  13 Aug 18:10:12 - TypeError: client.subscribeToDeviceCommand is not a function<br>	  nodered.service: Main process exited, code=exited, status=1/FAILURE<br>	  nodered.service: Unit entered failed state.<br>	  nodered.service: Failed with result 'exit-code'.<br>	  nodered.service: Service hold-off time over, scheduling restart.<br>	  Stopped Node-RED graphical event wiring tool..<br>	  Started Node-RED graphical event wiring tool..<br>	  13 Aug 18:10:15 - [info]<br>	  Welcome to Node-RED</p>	</blockquote>		<p><br>	This is my blumix credentials.</p>		<p><img src="https://i.stack.imgur.com/tEhYw.jpg" alt="img link"></p>	"
51820040,90622787,51820040,3,0,Tue Aug 14 05:54:00 EDT 2018,6240537,"in this case smth is wrong with the configuration. I see you have in the pics to connect as a gateway but in log it shows the connection to be as a device (d:h4v0iz:RaspberryPi:radberrypi). Please make sure that in the bluemix credentials you are using the date of a defined gateway within IoT Platform."
51820040,90689842,51820040,3,0,Thu Aug 16 03:12:00 EDT 2018,9806736,"Although, I received a new error,  "[wiot:connectionPool:getClient] Error: Connection refused: Identifier	rejected""
51820040,90689401,51820040,3,0,Thu Aug 16 02:30:00 EDT 2018,9806736,"Ok... so I made a new Gateway device on bluemix and entered the credentials. When I deployed it, my Node-RED didn't crash!"
51820040,90704389,51820040,3,0,Thu Aug 16 12:04:00 EDT 2018,6762442,"From 4th comment,  I conclude that the actual problem reported in the question is fixed.  So it would be good that you create an answer yourself specifying what you did to resolve the problem and accept it so that this question becomes logged as closed in stackoverflow.  For the new error  reported in the 5th comment you can always create a new question in stackoverflow."
51820040,90594604,51820040,3,0,Mon Aug 13 10:40:00 EDT 2018,6240537,""client.subscribeToDeviceCommand" seems to not be recognized as a function. I think you are using an old version of the node or smth changed. I suggest to check the npm repository of that node for a newer version."
51820040,90598294,51820040,3,0,Mon Aug 13 12:20:00 EDT 2018,9806736,"I'm currently using the latest version of IBM Watson IoT nodes."
51820040,90695572,51820040,3,0,Thu Aug 16 07:49:00 EDT 2018,6240537,"if use the gateway to publish on behalf of the radberrypi device, then you need to add that device to the gateway's resource group: https://console.bluemix.net/docs/services/IoT/gateways/gateway-access-control.html#gateway-access-control"
