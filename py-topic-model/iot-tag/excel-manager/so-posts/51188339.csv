thread_ID, Id, ParentId, PostType, Score, CreationDate, OwnerID, Body
51188339,51188339,null,1,2,Thu Jul 05 09:55:00 EDT 2018,10036212,"<p>I am trying to execute AT commands from a <a href="https://www.nordicsemi.com/eng/Products/Bluetooth-low-energy/nRF52-DK" rel="nofollow noreferrer">Nordic NRF52</a>. I am using the <a href="https://infocenter.nordicsemi.com/index.jsp?topic=%2Fcom.nordic.infocenter.sdk5.v14.0.0%2Fstructapp__uart__comm__params__t.html" rel="nofollow noreferrer">Nordic UART module</a> with a built-in function called <code>app_uart_put(uint8_t byte)</code> to put AT commands on the UART. The node that receiving the AT commands is a <a href="https://shop.exploratory.engineering/products/ee-nbiot-01-v1-1-breakout-module" rel="nofollow noreferrer">EE-NBIoT module</a> and it triggers on a postfix <code>\r\n</code>. When I run the following code, I get OK.</p>		<pre><code>while (app_uart_put('A') != NRF_SUCCESS);	while (app_uart_put('T') != NRF_SUCCESS);	while (app_uart_put('+') != NRF_SUCCESS);	while (app_uart_put('C') != NRF_SUCCESS);	while (app_uart_put('F') != NRF_SUCCESS);	while (app_uart_put('U') != NRF_SUCCESS);	while (app_uart_put('N') != NRF_SUCCESS);	while (app_uart_put('=') != NRF_SUCCESS);	while (app_uart_put('1') != NRF_SUCCESS);	while (app_uart_put('\r') != NRF_SUCCESS);	while (app_uart_put('\n') != NRF_SUCCESS);	</code></pre>		<p>But I want to make a more reusable code, so I wrote the following writeCommand function.</p>		<pre><code>void writeCommand(char cmd[])	{   	 while (app_uart_put('A') != NRF_SUCCESS);	 while (app_uart_put('T') != NRF_SUCCESS);	 while (app_uart_put('+') != NRF_SUCCESS);		 uint8_t i;	 for(i = 0; cmd[i] != '\0'; i++){	     while (app_uart_put(cmd[i]) != NRF_SUCCESS);	 }		 while (app_uart_put('\r') != NRF_SUCCESS);	 while (app_uart_put('\n') != NRF_SUCCESS);	 nrf_delay_ms(100);	}	</code></pre>		<p>When I run this function as shown below, I get ERROR.</p>		<pre><code>char cmd[] = "CFUN=1";	nrf_delay_ms(1000);	writeCommand(cmd);	</code></pre>		<p>Why does not this work? When I look at the outgoing commands, they are equal. </p>	"
51188339,89358298,51188339,3,1,Thu Jul 05 09:57:00 EDT 2018,4846598,"Which error do you get ?"
51188339,89358345,51188339,3,1,Thu Jul 05 09:58:00 EDT 2018,9072753,"Looks ok. One would only change `uint8_t i;` to `size_t i`."
51188339,89358392,51188339,3,1,Thu Jul 05 09:59:00 EDT 2018,3684343,"Is it correct that the first snippet sends `AT+CFUN=1` and the second sends `AT+CGATT=1`?"
51188339,89358422,51188339,3,0,Thu Jul 05 10:00:00 EDT 2018,10036212,"The EE-NBIoT module responds with ERROR  to the AT command. It does not say what's wrong, but it just does not accept the command"
51188339,89358573,51188339,3,0,Thu Jul 05 10:04:00 EDT 2018,5636775,"I would guess, that the error is outside the context you provide us. Maybe something is written to the uart before you call writecommand(): You could try and send `\r\n` first before sending your command."
51188339,89358599,51188339,3,0,Thu Jul 05 10:05:00 EDT 2018,10036212,"Both should send CFUN=1, I wrote wrong!"
51188339,89359557,51188339,3,0,Thu Jul 05 10:29:00 EDT 2018,10036212,"thank you @Ctx! it seems that the `\r\n` in front of the command that caused the problem"
51188339,89360371,51188339,3,1,Thu Jul 05 10:50:00 EDT 2018,765971,"\r should be enough after AT-command. \n is not needed."
51188339,89376470,51188339,3,1,Thu Jul 05 17:57:00 EDT 2018,4253229,"Have you heard of arrays? Use one to store your command string!"
51188339,51197348,51188339,2,0,Thu Jul 05 17:54:00 EDT 2018,23118,"<p>Start by acquiring a large A3 sheet of paper, find a red pen and write 1000 times</p>		<blockquote>	  <p>I will never use <code>nrf_delay_ms</code> as a substitute for <strong>reading</strong> and <strong>parsing</strong> responses from a modem.</p>	  	  <p>I will never use <code>nrf_delay_ms</code> as a substitute for <strong>reading</strong> and <strong>parsing</strong> responses from a modem.</p>	  	  <p>I will never use <code>nrf_delay_ms</code> as a substitute for <strong>reading</strong> and <strong>parsing</strong> responses from a modem.</p>	  	  <p>I will never use <code>nrf_delay_ms</code> as a substitute for <strong>reading</strong> and <strong>parsing</strong> responses from a modem.</p>	  	  <p>I will never use <code>nrf_delay_ms</code> as a substitute for <strong>reading</strong> and <strong>parsing</strong> responses from a modem. </p>	  	  <p>...</p>	</blockquote>		<p>I had a brief look at the <a href="https://www.u-blox.com/sites/default/files/SARA-N2_ATCommands_%28UBX-16014887%29.pdf" rel="nofollow noreferrer">AT command documentation for U-Blox Sara N210</a>, and it seems decent although a bit brief on the introduction part. I suggest reading the V.250 specification first because that is much more thorough. So after writing your 1000 sentences, read <a href="https://stackoverflow.com/a/33266839/23118">this answer</a>, first following the instructions regarding V.250, and then implement something along the given code structure of how to properly handle AT command command/response text.</p>		<hr>		<p>Of course the first part was meant to be funny, but I am dead serious about the rest; you have some huge AT command knowledge "holes" you must fill. You will not be able have reliable communication until you do. It should not be very difficult, but it will require some effort.</p>	"
