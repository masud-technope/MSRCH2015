thread_ID, Id, ParentId, PostType, Score, CreationDate, OwnerID, Body
34332601,34332601,null,1,0,Thu Dec 17 10:44:00 EST 2015,5043475,"<p>I would like to extract value from <strong>MongoDB</strong> using <strong>Node-RED</strong>. Here in the below mentioned flow, <strong>RFID Reader running of Raspberry Pi</strong> reads <strong>RFID(ex:"badgeID":12)</strong> and produce value using MQTT, and same value is subscribe in Node-RED and this subscribe value is passed to <strong>MongoDB node</strong> in Node-RED in order to filter value based on this badgeID. In MongoDB database, structure of one document is looks like </p>		<pre><code>{ "_id": "5631a6ba7de98c4a497dfdcb", "badgeID": "1", "tempValue": 25,	"unitofMeasurement": "C" }	</code></pre>		<p>. For that my flow in Node-RED is as follows: </p>		<pre><code>[{"id":"3015a0de.cfea6","type":"mongodb","z":"6ab069e2.954f98","hostname":"127.0.0.1",	"port":"27017","db":"iotsuiteuser","name":"ProfileDB"},{"id":"5a6e14aa.a591ec","type":"mqtt-	broker","z":"6ab069e2.954f98","broker":"test.mosquitto.org","port":"1883","clientid":"",	"usetls":false,"verifyservercert":true,"compatmode":true,"keepalive":"15","cleansession":true,	"willTopic":"","willQos":"0","willRetain":"false","willPayload":"","birthTopic":"","birthQos	":"0","birthRetain":"false","birthPayload":""},{"id":"2ec6f370.d1390c","type":"mqtt in","z":"6ab069e2.954f98","name":"RFID Reader Subscriber","topic":"badgeDetected","broker":"5a6e14aa.a591ec","x":137,"y":151,"wires":[["fc22a30d.03dd6"]]},{"id":"fc22a30d.03dd6","type":"function","z":	"6ab069e2.954f98","name":"Proximity","func":"sensorMeasurement=JSON.parse(msg.payload);\nmsg.payload=sensorMeasurement.badgeID;	\nreturn msg;\n","outputs":1,"noerr":0,"x":365,"y":188,"wires":[["48d08989.b72f78"]]},{"id":	"bb7c3bfd.4483c8","type":"debug","z":"6ab069e2.954f98","name":"Debug","active":true,"console":	"false","complete":"payload[0].tempValue","x":930,"y":221,"wires":[]},{"id":	"48d08989.b72f78","type":"mongodb in","z":"6ab069e2.954f98","mongodb":"3015a0de.cfea6","name":"ProfileDB","collection":"ProfileDB","operation":"find","x":613,"y":191,"wires":[["bb7c3bfd.4483c8"]]}]	</code></pre>		<p>Output display in the Node-RED debug console is as follows:</p>		<pre><code>[ { "_id": "5631a6ba7de98c4a497dfdcb", "badgeID": "1", "tempValue": 25,	"unitofMeasurement": "C" }, { "_id": "5631a6cd7de98c4a497dfdcc", "badgeID": "2", 	 "tempValue": 28, "unitofMeasurement": "C" }, { "_id": "5631b84023f7c97bc1044178", "badgeID": "3", "tempValue": 31, "unitofMeasurement": "c" }, { "_id": "565175ded239daf9794b1d48", "badgeID":	"4", "tempValue": 24, "unitOfMeasurement": "C" }, { "_id": "567287cc5e18a39f297395d6", 	"badgeID": "69d65035", "tempValue": 33, "unitofMeasurement": "C" } ]	</code></pre>		<p>I want to select tempValue where badgeID="69d65035". Here the problem is it displays all the document in the given collection. How to do this ? Am i going on wrong path ?	Snippet of document in the MongoDB database is as follows: 	<a href="https://i.stack.imgur.com/hnc7X.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/hnc7X.png" alt="enter image description here"></a></p>	"
34332601,56407608,34332601,3,0,Thu Dec 17 11:14:00 EST 2015,504554,"Just posting your flow doesn't really make it easy for people to help. Please update the question with a description of the message you are passing into the mongo node"
34332601,56408168,34332601,3,0,Thu Dec 17 11:29:00 EST 2015,504554,"Posting the code in your function node that is linked to the mongo node would have made answering this 10000% easier"
34332601,34333537,34332601,2,2,Thu Dec 17 11:32:00 EST 2015,504554,"<p>Your function node contains the following:</p>		<pre><code>sensorMeasurement=JSON.parse(msg.payload);	msg.payload=sensorMeasurement.badgeID;	return msg;	</code></pre>		<p>This is going to send just <code>"69d65030"</code> to the mongo node, which it won't have a clue which field in the document to match this to.</p>		<p>The Mongo find doc says you need to pass and object to use for the filter, so to match the badgeID you would need the payload to look something like this:</p>		<pre><code>{ badgeID: '69d65030'}	</code></pre>		<p>To do this the function should look like this:</p>		<pre><code>sensorMeasurement=JSON.parse(msg.payload);	msg.payload={ badgeID: sensorMeasurement.badgeID};	return msg;	</code></pre>	"
34332601,56410281,34333537,3,0,Thu Dec 17 12:24:00 EST 2015,5043475,"I also tried to implement logic suggested by you in that case output is like : 17/12/2015, 17:53:213e117b43.c1ee84	badgeDetected : msg.payload : array [1]	[ { "_id": "56729b785e18a39f297395d7", "badgeID": "69d65035", "tempValue": 25, "unitofMeasurement": "c" } ]"
34332601,56408564,34333537,3,0,Thu Dec 17 11:40:00 EST 2015,5043475,"Have you checked Proximity Node ???? I mean it is same as what you suggested."
34332601,56408706,34333537,3,0,Thu Dec 17 11:44:00 EST 2015,504554,"Your function node with name "Proximity" contains the code I listed at the start of the answer, not the code a the end which should work."
34332601,34334800,34332601,2,0,Thu Dec 17 12:36:00 EST 2015,5043475,"<p>Finally I figure out the Answer. Logic for <strong>Proximity</strong> node is as follows:</p>		<pre><code>sensorMeasurement=JSON.parse(msg.payload);	msg.payload={ badgeID: sensorMeasurement.badgeID};	msg.projection = {'_id' : 0,'tempValue':1};	return msg;	</code></pre>		<p>Above code only fetch tempValue from database.</p>	"
