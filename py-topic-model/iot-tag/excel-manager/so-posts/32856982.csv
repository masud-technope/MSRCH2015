thread_ID, Id, ParentId, PostType, Score, CreationDate, OwnerID, Body
32856982,32856982,null,1,1,Wed Sep 30 02:55:00 EDT 2015,3330190,"<p>I'm programming in a NodeMCU using LuaLoader. I'm trying to read the ADC of the Node and send it to a PHP file in my public domain.</p>		<p>With the next code I get the adc and the Node's IP and send it through GET.</p>		<pre><code>x = adc.read(0);	ip = wifi.sta.getip();		conn=net.createConnection(net.TCP, 0) 	conn:on("receive", function(conn, payload) print(payload) end) 	conn:connect(80,'example.com') 	conn:send("GET /data.php?mdata="..x.."&amp;ip="..ip.." HTTP/1.1\r\n") 	conn:send("Host: example.com\r\n") 	conn:send("Connection: keep-alive\r\nAccept: */*\r\n") 	conn:send("User-Agent: Mozilla/4.0 (compatible; esp8266 Lua; Windows NT 5.1)\r\n")	conn:send("\r\n")	print ("Done")	</code></pre>		<p>The code works correctly. If I paste this in my LuaLoader it will return:</p>		<pre><code> HTTP/1.1 200 OK	 Date: Wed, 30 Sep 2015 02:47:51 GMT	 Server: Apache	 X-Powered-By: PHP/5.5.26	 Content-Length: 0	 Keep-Alive: timeout=2, max=100	 Connection: Keep-Alive	 Content-Type: text/html		 Done	</code></pre>		<p>However, I want to repeat the code inside an alarm and send the data each minute, but it doesnt work.</p>		<pre><code>tmr.alarm(0, 60000, 1, function()	    x = adc.read(0);	    ip = wifi.sta.getip();		    conn=net.createConnection(net.TCP, 0) 	    conn:on("receive", function(conn, payload) print(payload) end) 	    conn:connect(80,'example.com') 	    conn:send("GET /data.php?mdata="..x.."&amp;ip="..ip.." HTTP/1.1\r\n") 	    conn:send("Host: example.com\r\n") 	    conn:send("Connection: keep-alive\r\nAccept: */*\r\n") 	    conn:send("User-Agent: Mozilla/4.0 (compatible; esp8266 Lua; Windows NT 5.1)\r\n")	    conn:send("\r\n")	    print ("Done")	 end )	</code></pre>		<p>The output is only...</p>		<pre><code> Done	</code></pre>		<p>...without the payload. It is not sending the data. </p>		<p>I tried putting the code in a function, in another file and calling it to the alarm with <strong>dotfile</strong> but it does not work. I tried giving it more time to send the data extending the alarm 2 minutes but nothing.</p>	"
32856982,32860001,32856982,2,0,Wed Sep 30 07:10:00 EDT 2015,1190388,"<p>From the documentation of <a href="https://github.com/nodemcu/nodemcu-firmware/wiki/nodemcu_api_en#tmralarm" rel="nofollow"><code>tmr.alarm</code></a>, the 3rd argument can be <code>0</code> or <code>1</code>:</p>		<pre><code>repeat: `0` - one time alarm, `1` - repeat	</code></pre>		<p>Since you are passing <code>0</code>, it is executing the function just once. Pass <code>1</code> instead:</p>		<pre><code>tmr.alarm(0, 60000, 1, function()	    x = adc.read(0);	    ip = wifi.sta.getip();		    conn=net.createConnection(net.TCP, 0) 	    conn:on("receive", function(conn, payload) print(payload) end) 	    conn:connect(80,'robcc.esy.es') 	    conn:send("GET /data.php?mdata="..x.."&amp;ip="..ip.." HTTP/1.1\r\n") 	    conn:send("Host: robcc.esy.es\r\n") 	    conn:send("Connection: keep-alive\r\nAccept: */*\r\n") 	    conn:send("User-Agent: Mozilla/4.0 (compatible; esp8266 Lua; Windows NT 5.1)\r\n")	    conn:send("\r\n")	    print ("Done")	end )	</code></pre>	"
32856982,53575337,32860001,3,0,Wed Sep 30 17:02:00 EDT 2015,3330190,"Yes, I tried at last moment changing it to 0, but still with 1  in the 3rd argument still it does not send anything."
32856982,32962202,32856982,2,0,Tue Oct 06 05:15:00 EDT 2015,3330190,"<p>I found the answer. I added a callback when the connection is established. The alarm probably was resetting the connection before sending the package.</p>		<pre><code>x = adc.read(0);	ip = wifi.sta.getip();		conn=net.createConnection(net.TCP, 0) 	conn:on("receive", function(conn, payload) 	    print ("\nDone---------------")	    print(payload)     	end)		conn:on("connection", function(conn, payload) 	   print('\nConnected...') 	   conn:send("GET /data.php?mdata="..x.."&amp;ip="..ip.." HTTP/1.1\r\n"	        .."Host: example.com\r\n" 	        .."Connection: keep-alive\r\nAccept: */*\r\n"	        .."User-Agent: Mozilla/4.0 (compatible; esp8266 Lua; Windows NT 5.1)\r\n"	        .."\r\n")	end)		conn:connect(80,'example.com')	</code></pre>	"
