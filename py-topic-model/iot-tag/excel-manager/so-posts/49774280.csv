thread_ID, Id, ParentId, PostType, Score, CreationDate, OwnerID, Body
49774280,49774280,null,1,1,Wed Apr 11 11:45:00 EDT 2018,9529968,"<p>We have an IoT based application device which is configured to communication with our Dashboard via MQTT bridge from Various service providers like Google, AWS and Azure.</p>		<p>So the flow is:</p>		<ol>	<li>Device start TLS session with service provider.  </li>	<li>Subscribe to a particular topic and wait for messages from the	service provider with 5 second timeout.  </li>	<li>Dashboard publishes messages to same topic periodically.  </li>	<li>IoT service provider broadcast it to all devices subscribed.</li>	</ol>		<p>Publish and subscribe messages are with MQTT <strong>QOS 1</strong> services.</p>		<p><strong>Observation:</strong></p>		<p>AWS and Azure works fine with above flow, but device stop receiving messages from Google MQTT bridge after 3-5 successful iterations even though our dashboard is publishing messages to Google IoT MQTT bridge.</p>		<p>For Google, we have identified that control flow is different when compared with Azure and AWS.</p>		<p>For Google, we need to subscribe and un-subscribe for a given topic every-time before waiting to receive message while for AWS and Azure we need to subscribe once during opening a MQTT connection.</p>		<p><strong>Issue:</strong></p>		<p>Sometime 5 sec device timeout occurs as it could not receive messages for subscribed topic from Google MQTT bridge. Adding multiple retries to overcome timeout issue was unsuccessful as issue still persist as device could not receive message from Google MQTT bridge after 45-60sec of device operation after powering on.</p>		<ul>	<li>Is there is constraint with Google MQTT bridge to receive messages periodically without subscribing it every-time?</li>	<li>How can device receive messages without timing out (5 sec) from Google MQTT bridge?</li>	<li>Is there any workaround to recover a device once it got timed out with establishing MQTT reconnection?</li>	</ul>	"
49774280,86580117,49774280,3,0,Wed Apr 11 18:47:00 EDT 2018,1930814,"I am also facing some problems with pub/sub of the google cloud platform, although different of yours. Are you using the google pub/sub library or implemented your own code using some mqtt library to subscribe to topics?"
49774280,49836586,49774280,2,0,Sat Apr 14 21:59:00 EDT 2018,3286882,"<p>I am using google iot core as well,the device side code for the mqtt client is golang while using paho mqtt package. this client package support OnConnect handler which while using this handler I achieve the recovery which I think you are looking for. 	Via this handler I am re-subscribing to the "config" topic.</p>		<p>I think that google does not save the subscriptions which the clients are subscribed to and therefore the client needs to re-subscribe upon successful connection</p>	"
49774280,86740348,49836586,3,0,Mon Apr 16 17:02:00 EDT 2018,1930814,"It is highly recommended you provide some code..."
49774280,51260455,49774280,2,0,Tue Jul 10 08:24:00 EDT 2018,10057960,"<p>Here's the golang code I've used (inspired by gingi007's answer, thank you!)</p>		<pre><code>var onConn MQTT.OnConnectHandler	onConn = func(client MQTT.Client) {	    fmt.Println("connected")	    client.Subscribe(topic.Config, 1, handlerFunc)	}	mqttOpts.SetOnConnectHandler(onConn)	client := MQTT.NewClient(mqttOpts)	</code></pre>		<p>this way config updates keep flowing to my device, while if you subscribe outside of the onConnectHandler you'll just receive one config update when you connect.</p>	"
